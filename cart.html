<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Selection | Creme Theory</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2 { font-family: 'Playfair Display', serif; }
        input:checked + div { border-color: white; background-color: rgba(255,255,255,0.1); }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <nav class="p-6 max-w-7xl mx-auto flex justify-between items-center">
        <a href="index.html" class="text-xl font-bold tracking-tighter text-amber-900 uppercase">Creme Theory</a>
        <a href="menu.html" class="text-sm font-semibold text-stone-500 hover:text-amber-900 transition">‚Üê Back to Menu</a>
    </nav>

    <main class="max-w-3xl mx-auto px-6 py-12">
        <h1 class="text-4xl text-amber-900 mb-8">Your Selection</h1>

        <div id="cart-items" class="bg-white rounded-2xl shadow-sm border border-stone-200 overflow-hidden mb-8"></div>

        <div class="bg-amber-900 text-white p-8 rounded-3xl shadow-xl">
            <div class="flex justify-between items-center mb-6 border-b border-white/10 pb-6">
                <span class="opacity-80 uppercase tracking-widest text-xs font-bold">Total Amount</span>
                <span id="total-price" class="text-3xl font-bold">$0 JMD</span>
            </div>

            <div class="space-y-6">
                <div>
                    <label class="block text-[10px] uppercase tracking-widest font-bold mb-2 opacity-70">Full Name</label>
                    <input type="text" id="customer-name" placeholder="Enter your name" class="w-full p-4 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-white transition text-white">
                </div>

                <div>
                    <label class="block text-[10px] uppercase tracking-widest font-bold mb-3 opacity-70">Delivery Method</label>
                    <div class="grid grid-cols-2 gap-4">
                        <label class="cursor-pointer">
                            <input type="radio" name="delivery" value="Pickup" checked class="hidden peer">
                            <div class="p-4 border border-white/20 rounded-xl text-center peer-checked:bg-white peer-checked:text-amber-900 transition font-bold text-sm">üìç Pickup</div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="delivery" value="Delivery" class="hidden peer">
                            <div class="p-4 border border-white/20 rounded-xl text-center peer-checked:bg-white peer-checked:text-amber-900 transition font-bold text-sm">üöö Delivery</div>
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-[10px] uppercase tracking-widest font-bold mb-3 opacity-70">Payment Method</label>
                    <div class="grid grid-cols-2 gap-4">
                        <label class="cursor-pointer">
                            <input type="radio" name="payment" value="Bank Transfer" checked class="hidden peer">
                            <div class="p-4 border border-white/20 rounded-xl text-center peer-checked:bg-white peer-checked:text-amber-900 transition font-bold text-sm">üè¶ Bank Transfer</div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="payment" value="Cash / Other" class="hidden peer">
                            <div class="p-4 border border-white/20 rounded-xl text-center peer-checked:bg-white peer-checked:text-amber-900 transition font-bold text-sm">üíµ Cash / Other</div>
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-[10px] uppercase tracking-widest font-bold mb-2 opacity-70">Special Instructions / Location</label>
                    <textarea id="special-notes" rows="2" placeholder="Address for delivery or allergy notes..." class="w-full p-4 rounded-xl bg-white/10 border border-white/20 outline-none focus:border-white transition text-white resize-none"></textarea>
                </div>

                <div class="flex items-start gap-3 py-2">
                    <input type="checkbox" id="terms-check" class="mt-1 accent-white w-4 h-4">
                    <label for="terms-check" class="text-xs opacity-80 leading-relaxed">
                        I agree to the <a href="terms.html" class="underline font-bold hover:text-stone-200">Terms and Conditions</a>, including the 50% non-refundable deposit required for all orders.
                    </label>
                </div>
                
                <button onclick="sendOrder()" class="w-full bg-white text-amber-900 py-5 rounded-2xl font-black uppercase tracking-widest hover:bg-stone-100 transition shadow-2xl flex justify-center items-center gap-3">
                    <span>Confirm & Send via WhatsApp</span>
                </button>
            </div>
        </div>

        <button onclick="clearCart()" class="w-full mt-12 text-stone-400 text-[10px] hover:text-red-500 transition uppercase tracking-widest font-bold">Clear Selection</button>
    </main>

    <script>
        let cart = JSON.parse(localStorage.getItem('creme_cart')) || [];

        function parsePrice(priceVal) {
            if (typeof priceVal === 'number') return priceVal;
            return parseFloat(priceVal.replace(/[^0-9.]/g, '')) || 0;
        }

        function renderCheckout() {
            const container = document.getElementById('cart-items');
            const totalDisplay = document.getElementById('total-price');
            
            if (cart.length === 0) {
                container.innerHTML = `<div class="p-16 text-center text-stone-400 italic">No items selected.</div>`;
                totalDisplay.innerText = "$0 JMD";
                return;
            }

            let total = 0;
            container.innerHTML = '';

            cart.forEach((item, index) => {
                const numericPrice = parsePrice(item.price);
                total += numericPrice;
                
                const row = document.createElement('div');
                row.className = "flex justify-between items-center p-6 border-b border-stone-100 last:border-0";
                row.innerHTML = `
                    <div>
                        <h3 class="font-bold text-stone-800">${item.name}</h3>
                        <p class="text-[10px] text-stone-400 uppercase">Item ID: ${item.id}</p>
                    </div>
                    <div class="flex items-center gap-6">
                        <span class="font-semibold text-amber-900">$${numericPrice.toLocaleString()}</span>
                        <button onclick="removeItem(${index})" class="text-stone-300 hover:text-red-500 transition text-lg">&times;</button>
                    </div>
                `;
                container.appendChild(row);
            });

            totalDisplay.innerText = `$${total.toLocaleString()} JMD`;
        }

        function removeItem(index) {
            cart.splice(index, 1);
            localStorage.setItem('creme_cart', JSON.stringify(cart));
            renderCheckout();
        }

        function clearCart() {
            if(confirm("Clear selection?")) {
                cart = [];
                localStorage.setItem('creme_cart', JSON.stringify(cart));
                renderCheckout();
            }
        }

        function sendOrder() {
            const name = document.getElementById('customer-name').value.trim();
            const notes = document.getElementById('special-notes').value.trim();
            const delivery = document.querySelector('input[name="delivery"]:checked').value;
            const payment = document.querySelector('input[name="payment"]:checked').value;
            const terms = document.getElementById('terms-check').checked;

            if (!name) { alert("Please provide your name."); return; }
            if (cart.length === 0) { alert("Cart is empty."); return; }
            if (!terms) { alert("Please agree to the Terms and Conditions."); return; }

            let total = 0;
            let itemList = "";
            cart.forEach(item => {
                const nPrice = parsePrice(item.price);
                itemList += `%0A‚Ä¢ ${item.name} ($${nPrice.toLocaleString()})`;
                total += nPrice;
            });

            let message = `*NEW ORDER - CREME THEORY*%0A%0A`;
            message += `*Customer:* ${name}%0A`;
            message += `*Delivery:* ${delivery}%0A`;
            message += `*Payment:* ${payment}%0A`;
            message += `%0A*Order Details:* ${itemList}%0A%0A`;
            message += `*Total Amount:* $${total.toLocaleString()} JMD%0A`;
            
            if (notes) { message += `%0A*Instructions/Address:* ${notes}`; }
            message += `%0A%0A_I agree to the Terms & Conditions._`;

            const phoneNumber = "18765398891"; 
            window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
        }

        window.onload = renderCheckout;
    </script>
</body>
</html>
